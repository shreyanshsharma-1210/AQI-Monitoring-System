<div align="center">

<img src="https://capsule-render.vercel.app/api?type=waving&color=gradient&customColorList=2,12,24&height=200&section=header&text=AQIFY&fontSize=90&fontAlignY=35&animation=twinkling&fontColor=fff" />

<h3>ğŸŒ«ï¸ Real-Time AQI Intelligence Engine â€” Powered by Pathway</h3>
<h4><i>Live air quality data. Personalised health insights. Gamified engagement.</i></h4>

[![Pathway](https://img.shields.io/badge/Pathway-Stream_Processing-6366F1?style=for-the-badge&logo=python&logoColor=white)](https://pathway.com)
[![React](https://img.shields.io/badge/React_18-20232A?style=for-the-badge&logo=react&logoColor=61DAFB)](https://reactjs.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-009688?style=for-the-badge&logo=fastapi&logoColor=white)](https://fastapi.tiangolo.com/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white)](https://www.postgresql.org/)
[![Redis](https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white)](https://redis.io/)
[![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)](https://www.docker.com/)

<h4>
  <a href="#-quick-start">Quick Start</a>
  <span> Â· </span>
  <a href="#-features">Features</a>
  <span> Â· </span>
  <a href="#-architecture">Architecture</a>
  <span> Â· </span>
  <a href="#-tech-stack">Tech Stack</a>
  <span> Â· </span>
  <a href="#-gamification">Gamification</a>
</h4>

<br/>

<img src="https://img.shields.io/badge/version-3.4-blue?style=flat-square" />
<img src="https://img.shields.io/badge/cities-45+-green?style=flat-square" />
<img src="https://img.shields.io/badge/pollutants-6-orange?style=flat-square" />
<img src="https://img.shields.io/badge/data_sources-WAQI_+_Open--Meteo-purple?style=flat-square" />
<img src="https://img.shields.io/badge/real--time-60s_refresh-red?style=flat-square" />

</div>

---

## ğŸ¯ The Problem We're Solving

<table>
<tr>
<td width="60%">

### ğŸŒ Air Quality â€” A Silent Crisis

Millions of Indians make daily decisions â€” when to exercise, whether to open windows, should children go to school â€” with zero understanding of the air they're breathing. Existing solutions fail them:

- ğŸ“Š **Raw numbers, no context** â€” AQI 147 means nothing without health guidance
- ğŸ‘¤ **Zero personalisation** â€” same advice for a 7-year-old asthmatic and a healthy adult athlete
- â³ **Stale data** â€” batch-refreshed dashboards showing yesterday's air quality today
- ğŸ™ï¸ **City-level only** â€” no drill-down to your neighbourhood station
- ğŸ“‰ **No historical depth** â€” can't compare today's air to the same day last year
- ğŸ˜´ **No engagement** â€” people check once, forget, never build healthy habits

> **AQIFY's answer**: A real-time, personalised, gamified AQI intelligence platform built on Pathway's stream processing engine â€” delivering live air quality insights that are actually actionable.

</td>
<td width="40%">

```mermaid
pie title India AQI Data Access Gap
    "No awareness" : 45
    "Generic dashboards" : 30
    "Personalised insight" : 10
    "Active monitors" : 15
```

### ğŸ“‰ The Reality

- **91%** of Indians breathe unsafe air (WHO)
- **60%** unaware of real-time AQI tools
- **<5%** receive personalised health guidance
- **0** platforms combine real-time + history + gamification

</td>
</tr>
</table>

---

## ğŸ’¡ Our Solution: AQIFY

<div align="center">

### **Real-Time AQI Intelligence, Personalised for Every Breath**

*Live Stream Processing Â· Multi-Pollutant Tracking Â· Historical Analysis Â· City Rankings Â· Gamified Health Engagement Â· Embeddable Widgets Â· Auto-Generated SEO Blog*

#### **10 Powerful Features. 1 Unified Platform. Powered by Pathway.**

<img src="https://img.shields.io/badge/âš¡-Real--Time_Stream-6366F1?style=for-the-badge" />
<img src="https://img.shields.io/badge/ğŸ‘¤-Personalised_Insights-10B981?style=for-the-badge" />
<img src="https://img.shields.io/badge/ğŸ†-Gamified_Engagement-F59E0B?style=for-the-badge" />
<img src="https://img.shields.io/badge/ğŸ—ºï¸-Live_Heatmap-EF4444?style=for-the-badge" />
<img src="https://img.shields.io/badge/ğŸ“Š-Historical_Analysis-3B82F6?style=for-the-badge" />

</div>

---

## âœ¨ Core Features

<table>
<tr>
<td width="33%" valign="top">

### ğŸ  Live AQI Dashboard
<img src="https://img.shields.io/badge/Real--time-60s_Updates-EF4444?style=flat-square" />

- ğŸ”´ Live AQI gauge with colour-coded health categories
- ğŸ¥ Personalised health advisory card
- ğŸ“ Per-station breakdown within your city
- ğŸŒ¤ï¸ Current weather: temp, humidity, wind, UV
- ğŸ“ˆ 24-hour AQI forecast chart
- ğŸ“… Year-over-year same-day insight

**Tech:**
<p>
<img src="https://img.shields.io/badge/Socket.IO-000000?style=flat-square&logo=socket.io&logoColor=white" />
<img src="https://img.shields.io/badge/Recharts-8884D8?style=flat-square" />
<img src="https://img.shields.io/badge/Pathway-6366F1?style=flat-square" />
</p>

</td>
<td width="33%" valign="top">

### ğŸ—ºï¸ India AQI Heatmap
<img src="https://img.shields.io/badge/45+-Cities_Live-10B981?style=flat-square" />

- ğŸŸ¢ğŸŸ¡ğŸ”´ Colour-coded city markers (Good â†’ Hazardous)
- ğŸ–±ï¸ Click any city to drill down
- ğŸ“ Sub-city station resolution
- ğŸ” AQI scale legend overlay
- ğŸ”„ Auto-refresh with live data

**Tech:**
<p>
<img src="https://img.shields.io/badge/Leaflet.js-199900?style=flat-square&logo=leaflet&logoColor=white" />
<img src="https://img.shields.io/badge/CARTO-990000?style=flat-square" />
<img src="https://img.shields.io/badge/WAQI_API-4285F4?style=flat-square" />
</p>

</td>
<td width="33%" valign="top">

### ğŸ”¬ Per-Pollutant Pages
<img src="https://img.shields.io/badge/6_Pollutants-Tracked-F59E0B?style=flat-square" />

- ğŸ“Š Dedicated pages for PM2.5, PM10, NOâ‚‚, Oâ‚ƒ, CO, SOâ‚‚
- ğŸ“‰ Last 120 readings chart with WHO/EPA threshold lines
- ğŸ“ˆ Average, maximum, minimum stats
- ğŸ”„ Switch pollutant with one click
- ğŸ“ Safe limit annotations on charts

**Tech:**
<p>
<img src="https://img.shields.io/badge/WAQI-Station_API-4285F4?style=flat-square" />
<img src="https://img.shields.io/badge/Recharts-8884D8?style=flat-square" />
</p>

</td>
</tr>

<tr>
<td width="33%" valign="top">

### ğŸ“… Historical AQI Analysis
<img src="https://img.shields.io/badge/Multi--Year-2023_â†’_2026-3B82F6?style=flat-square" />

- ğŸ“† Year-over-year monthly comparison (2023â€“2026)
- ğŸŒ… 24-hour AQI pattern over last 30 days
- ğŸ† Best hour / Worst hour statistics
- â˜€ï¸ Day average vs ğŸŒ™ Night average
- ğŸ“Š Hourly bar chart with colour coding

**Tech:**
<p>
<img src="https://img.shields.io/badge/PostgreSQL-316192?style=flat-square&logo=postgresql&logoColor=white" />
<img src="https://img.shields.io/badge/Pathway_Write-6366F1?style=flat-square" />
<img src="https://img.shields.io/badge/Recharts-8884D8?style=flat-square" />
</p>

</td>
<td width="33%" valign="top">

### ğŸ™ï¸ City Rankings
<img src="https://img.shields.io/badge/Live-4_Sort_Modes-F59E0B?style=flat-square" />

- ğŸ”¥ Hottest / ğŸ§Š Coldest / ğŸ’¨ Most Polluted / âœ… Cleanest
- ğŸ“Š AQI + humidity + wind + temperature per city
- ğŸ”„ Updated every 5 minutes
- ğŸ“ 45+ Indian cities tracked
- ğŸ¯ One-click city drill-down

**Tech:**
<p>
<img src="https://img.shields.io/badge/Open--Meteo-0EA5E9?style=flat-square" />
<img src="https://img.shields.io/badge/WAQI-4285F4?style=flat-square" />
<img src="https://img.shields.io/badge/Pathway_Join-6366F1?style=flat-square" />
</p>

</td>
<td width="33%" valign="top">

### ğŸ† Gamified Leaderboard
<img src="https://img.shields.io/badge/Points_+_Badges-F59E0B?style=flat-square" />

- â­ Points for daily check-ins & health actions
- ğŸ… Badges for streaks and milestones
- ğŸŒ Global + city-level leaderboards
- ğŸ“ˆ Personal health score trend
- ğŸ¯ Daily challenges

**Tech:**
<p>
<img src="https://img.shields.io/badge/Supabase-3ECF8E?style=flat-square&logo=supabase&logoColor=white" />
<img src="https://img.shields.io/badge/PostgreSQL-316192?style=flat-square&logo=postgresql&logoColor=white" />
</p>

</td>
</tr>

<tr>
<td width="33%" valign="top">

### ğŸ§© Embeddable AQI Widget
<img src="https://img.shields.io/badge/Copy_+_Embed-10B981?style=flat-square" />

- ğŸ“‹ One-line `<script>` embed code
- ğŸ™ï¸ City-configurable, auto-updating
- ğŸ¨ Matches host site theme
- ğŸ“± Responsive for any screen size
- ğŸ”— Links back to full AQIFY dashboard

**Tech:**
<p>
<img src="https://img.shields.io/badge/Vanilla_JS-F7DF1E?style=flat-square&logo=javascript&logoColor=black" />
<img src="https://img.shields.io/badge/iframe_API-333333?style=flat-square" />
</p>

</td>
<td width="33%" valign="top">

### ğŸŒ Multi-Language Support (i18n)
<img src="https://img.shields.io/badge/Auto--Detect-Browser_Language-8B5CF6?style=flat-square" />

- ğŸ”¤ Auto-detects browser locale
- ğŸ‡®ğŸ‡³ Hindi, Tamil, Telugu, Bengali + more
- ğŸ”„ Runtime language switching
- ğŸ·ï¸ All health advisory text translated
- âœ… AQI scale labels localised

**Tech:**
<p>
<img src="https://img.shields.io/badge/i18next-26A69A?style=flat-square" />
<img src="https://img.shields.io/badge/react--i18next-61DAFB?style=flat-square" />
</p>

</td>
<td width="33%" valign="top">

### ğŸ“ Auto-Generated SEO Blog
<img src="https://img.shields.io/badge/Weekly_Auto--Posts-EF4444?style=flat-square" />

- ğŸ¤– Weekly auto-generated city AQI reports
- ğŸ” SEO-optimised meta tags per page
- ğŸ“° Markdown-rendered blog posts
- ğŸ“… APScheduler cron every Monday 6AM
- ğŸŒ City-specific content at scale

**Tech:**
<p>
<img src="https://img.shields.io/badge/APScheduler-3B82F6?style=flat-square" />
<img src="https://img.shields.io/badge/react--markdown-333333?style=flat-square" />
<img src="https://img.shields.io/badge/react--helmet-E11D48?style=flat-square" />
</p>

</td>
</tr>
</table>

---

## ğŸ–¥ï¸ App Screenshots

<div align="center">

| Screen | What You See |
|--------|-------------|
| ğŸ  **Dashboard** | Live AQI 52 (Moderate) for Indore â€” health advisory, station breakdown, weather widget, 24h forecast, YoY insight, pollutant bars |
| ğŸ—ºï¸ **Heatmap** | 45+ Indian cities colour-coded by AQI in real time â€” green to red, click to drill down |
| ğŸ“Š **History** | Year-over-year monthly comparison 2023â€“2026, 24h daily pattern, best/worst hour analysis |
| ğŸ”¬ **Pollutants** | PM2.5 history chart for last 120 readings â€” 53.7 avg, 78.0 max, 25.0 min with EPA threshold lines |
| ğŸ™ï¸ **Rankings** | 45 cities ranked by Hottest / Coldest / Most Polluted / Cleanest with live AQI + weather data |

</div>

---

## ğŸ—ï¸ System Architecture

<div align="center">

### **Pathway-Powered Real-Time Pipeline**

</div>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DATA SOURCES                                    â”‚
â”‚   [WAQI API]               [Open-Meteo API]       [User Geolocation]     â”‚
â”‚   Real govt station AQI    Weather + AQI Forecast  Browser GPS           â”‚
â”‚   US 0â€“500 scale           Free Â· No API key       Community reports     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”˜
       â”‚ poll every 60s               â”‚ poll every 300s
       â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PATHWAY AQI PIPELINE  (pathway_aqi_pipeline.py)              â”‚
â”‚                                                                            â”‚
â”‚   WAQIStationConnectorSubject    OpenMeteoConnectorSubject                 â”‚
â”‚   pw.io.python.read()            pw.io.python.read()                      â”‚
â”‚          â”‚                               â”‚                                 â”‚
â”‚          â–¼                               â–¼                                 â”‚
â”‚   station_table â”€â”€â”€â”€ LEFT JOIN â”€â”€â”€â”€ weather_table   (joined on city_id)   â”‚
â”‚          â”‚                                                                 â”‚
â”‚          â–¼                                                                 â”‚
â”‚      combined_table                                                        â”‚
â”‚       â”œâ”€â”€ classify_aqi()    â†’ health_category column                       â”‚
â”‚       â””â”€â”€ alert_filter()    â†’ rows where aqi > threshold                  â”‚
â”‚          â”‚                                                                 â”‚
â”‚          â”œâ”€â”€â–º Redis pub/sub  (aqi:live)                                    â”‚
â”‚          â””â”€â”€â–º pw.io.postgres.write_snapshot  â†’ aqi_history table          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FASTAPI SERVER  (api/main.py Â· port 8000)                    â”‚
â”‚   REST endpoints + Socket.IO server                                        â”‚
â”‚   Subscribes Redis "aqi:live" â†’ broadcasts to browser clients             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FRONTEND  (React 18 + Vite Â· port 3000)                     â”‚
â”‚   Dashboard Â· Heatmap Â· Pollutants Â· History Â· Rankings Â· Leaderboard    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```mermaid
graph TB
    subgraph "Data Sources"
        W[WAQI API<br/>Real Govt AQI Â· 60s]
        OM[Open-Meteo API<br/>Weather + Forecast Â· 300s]
        GEO[Browser Geolocation]
    end

    subgraph "Pathway Pipeline"
        WC[WAQIConnectorSubject<br/>pw.io.python.read]
        MC[OpenMeteoConnectorSubject<br/>pw.io.python.read]
        JOIN[LEFT JOIN on city_id]
        CLASSIFY[classify_aqi UDF]
        ALERT[alert_filter UDF]
    end

    subgraph "IPC Layer"
        REDIS[(Redis pub/sub<br/>aqi:live channel)]
        PG[(PostgreSQL<br/>aqi_history Â· snapshots)]
    end

    subgraph "API Layer"
        FASTAPI[FastAPI + python-socketio<br/>port 8000]
    end

    subgraph "Frontend"
        DASH[Dashboard]
        MAP[Heatmap]
        POLL[Pollutants]
        HIST[History]
        RANK[Rankings]
        LEAD[Leaderboard]
    end

    W --> WC
    OM --> MC
    WC --> JOIN
    MC --> JOIN
    JOIN --> CLASSIFY
    CLASSIFY --> ALERT
    ALERT --> REDIS
    ALERT --> PG
    REDIS --> FASTAPI
    PG --> FASTAPI
    GEO --> FASTAPI
    FASTAPI -->|Socket.IO| DASH
    FASTAPI -->|REST| MAP
    FASTAPI -->|REST| POLL
    FASTAPI -->|REST| HIST
    FASTAPI -->|REST| RANK
    FASTAPI -->|REST| LEAD

    style WC fill:#6366f1,stroke:#333,color:#fff
    style MC fill:#6366f1,stroke:#333,color:#fff
    style JOIN fill:#6366f1,stroke:#333,color:#fff
    style REDIS fill:#DC382D,stroke:#333,color:#fff
    style PG fill:#316192,stroke:#333,color:#fff
    style FASTAPI fill:#009688,stroke:#333,color:#fff
```

### Key Architectural Decisions

| Decision | Reason |
|----------|---------|
| `pw.io.python.ConnectorSubject` for ingestion | `pw.io.http.read` is a webhook listener, NOT an HTTP client. `ConnectorSubject` is the correct Pathway pattern for polling external REST APIs |
| Redis pub/sub (direct from Pathway) | Pathway publishes to `aqi:live`; FastAPI subscribes and relays to Socket.IO â€” zero file-based bridging |
| Celery removed entirely | Pathway's `ConnectorSubject` handles all background polling in a persistent loop. Celery would conflict |
| WAQI as primary AQI source | Returns real US AQI 0â€“500 from government stations. OpenWeatherMap only returns a 1â€“5 ordinal index |
| Open-Meteo for weather + forecast | Completely free, no API key, 5-day AQI forecast via CAMS European model |
| `@pw.udf` throughout pipeline | Replaces deprecated `pw.apply()` â€” verified against official Pathway 0.27.0 API |

---

## ğŸ› ï¸ Tech Stack

<div align="center">

### **Production-Grade Â· Stream-Native Â· Containerised**

</div>

### Backend

<table>
<tr>
<td width="50%">

#### Stream Processing
<p>
<img src="https://img.shields.io/badge/Pathway_0.27.0-Stream_Engine-6366F1?style=for-the-badge&logo=python&logoColor=white" />
</p>

- `pw.io.python.ConnectorSubject` â€” polls WAQI + Open-Meteo
- `@pw.udf` decorator â€” classify AQI, compute health categories
- `pw.io.postgres.write_snapshot` â€” persistent history writes
- `pw.Table.join` â€” real-time dual-source stream merging

#### API Server
<p>
<img src="https://img.shields.io/badge/FastAPI-009688?style=for-the-badge&logo=fastapi&logoColor=white" />
<img src="https://img.shields.io/badge/python--socketio-000000?style=for-the-badge" />
<img src="https://img.shields.io/badge/uvicorn-499848?style=for-the-badge" />
</p>

</td>
<td width="50%">

#### Data & IPC
<p>
<img src="https://img.shields.io/badge/PostgreSQL_15-316192?style=for-the-badge&logo=postgresql&logoColor=white" />
<img src="https://img.shields.io/badge/Redis_7-DC382D?style=for-the-badge&logo=redis&logoColor=white" />
</p>

- Redis pub/sub: `aqi:live` channel (Pathway â†’ FastAPI)
- PostgreSQL: `station_aqi_history`, `aqi_snapshot`, `city_registry`
- asyncpg + SQLAlchemy 2.0 for async queries
- Alembic for migrations

#### Scheduling
<p>
<img src="https://img.shields.io/badge/APScheduler-3B82F6?style=for-the-badge" />
</p>

- Monday 6AM cron â†’ auto-generates weekly city blog posts

</td>
</tr>
</table>

### Frontend

<table>
<tr>
<td width="50%">

#### Core Framework
<p>
<img src="https://img.shields.io/badge/React_18-20232A?style=for-the-badge&logo=react&logoColor=61DAFB" />
<img src="https://img.shields.io/badge/Vite_5-646CFF?style=for-the-badge&logo=vite&logoColor=white" />
<img src="https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white" />
</p>

#### State & Auth
<p>
<img src="https://img.shields.io/badge/Zustand-FF6B35?style=for-the-badge" />
<img src="https://img.shields.io/badge/Supabase-3ECF8E?style=for-the-badge&logo=supabase&logoColor=white" />
</p>

#### Real-Time
<p>
<img src="https://img.shields.io/badge/socket.io--client-000000?style=for-the-badge&logo=socket.io&logoColor=white" />
</p>

</td>
<td width="50%">

#### Maps & Charts
<p>
<img src="https://img.shields.io/badge/Leaflet.js-199900?style=for-the-badge&logo=leaflet&logoColor=white" />
<img src="https://img.shields.io/badge/react--leaflet-199900?style=for-the-badge" />
<img src="https://img.shields.io/badge/Recharts-8884D8?style=for-the-badge" />
</p>

#### Internationalisation & SEO
<p>
<img src="https://img.shields.io/badge/i18next-26A69A?style=for-the-badge" />
<img src="https://img.shields.io/badge/react--i18next-61DAFB?style=for-the-badge" />
<img src="https://img.shields.io/badge/react--helmet--async-E11D48?style=for-the-badge" />
</p>

#### Styling
<p>
<img src="https://img.shields.io/badge/Tailwind_CSS-38B2AC?style=for-the-badge&logo=tailwind-css&logoColor=white" />
<img src="https://img.shields.io/badge/shadcn/ui-161618?style=for-the-badge" />
<img src="https://img.shields.io/badge/lucide--react-F97316?style=for-the-badge" />
</p>

</td>
</tr>
</table>

### External APIs

| API | Purpose | Cost | Refresh |
|-----|---------|------|---------|
| ğŸŒ«ï¸ **WAQI** | Real US AQI 0â€“500 from government stations | Free tier | 60 seconds |
| ğŸŒ¤ï¸ **Open-Meteo** | Weather + 5-day AQI forecast (CAMS) | **Completely free Â· No key** | 300 seconds |
| ğŸ“ **IPinfo** | Visitor IP â†’ city geolocation | Free tier | On request |
| ğŸ” **Supabase** | Auth + gamification data | Free tier | Real-time |

### Docker Containers

| Container | Base Image | Size | Purpose |
|-----------|-----------|------|---------|
| `pathway_aqi` | python:3.11-slim | ~215 MB | Pathway stream pipeline |
| `api` | python:3.11-slim | ~165 MB | FastAPI + Socket.IO + Blog |
| `frontend` | nginx:alpine | ~21 MB | React SPA |
| `postgres` | postgres:15-alpine | ~240 MB | Persistent storage |
| `redis` | redis:7-alpine | ~35 MB | IPC pub/sub |
| **Total** | | **~676 MB** | All 5 containers |

---

## ğŸ“Š AQI Scale Reference

<div align="center">

| Category | AQI Range | Health Implication | Colour |
|----------|-----------|-------------------|--------|
| ğŸŸ¢ **Good** | 0â€“50 | Air quality satisfactory, minimal risk | `#00E400` |
| ğŸŸ¡ **Moderate** | 51â€“100 | Acceptable; some pollutants may concern sensitive groups | `#FFFF00` |
| ğŸŸ  **USG** | 101â€“150 | Unhealthy for Sensitive Groups | `#FF7E00` |
| ğŸ”´ **Unhealthy** | 151â€“200 | Everyone may begin to experience health effects | `#FF0000` |
| ğŸŸ£ **Very Unhealthy** | 201â€“300 | Health alert â€” serious effects for everyone | `#8F3F97` |
| ğŸŸ¤ **Hazardous** | 300+ | Emergency conditions; entire population affected | `#7E0023` |

</div>

---

## ğŸ† Gamification System

<div align="center">

### **Keep Users Breathing Mindfully â€” Every Day**

<img src="https://img.shields.io/badge/Daily_Streaks-ğŸ”¥-FF4500?style=for-the-badge" />
<img src="https://img.shields.io/badge/Health_Badges-ğŸ…-F59E0B?style=for-the-badge" />
<img src="https://img.shields.io/badge/City_Leaderboards-ğŸ†-10B981?style=for-the-badge" />
<img src="https://img.shields.io/badge/Points_System-â­-6366F1?style=for-the-badge" />

</div>

<table>
<tr>
<td width="50%">

#### â­ Points System

| Action | Points |
|--------|--------|
| Daily dashboard check-in | +10 |
| Check AQI during Unhealthy day | +20 |
| 7-day streak maintained | +50 bonus |
| Share AQI alert with community | +15 |
| Complete health challenge | +30 |
| First check of the month | +25 |

</td>
<td width="50%">

#### ğŸ… Badge Categories

| Badge | Unlock Condition |
|-------|-----------------|
| ğŸŒ± **Air Aware** | First check-in |
| ğŸ”¥ **Week Warrior** | 7-day streak |
| ğŸŒ **City Guardian** | Top 10 local leaderboard |
| ğŸŒ¬ï¸ **Breath Expert** | 30-day streak |
| ğŸ† **AQI Champion** | #1 on city leaderboard |
| ğŸ“Š **Data Nerd** | Viewed history 10+ times |

</td>
</tr>
</table>

---

## ğŸ“‚ Project Structure

```
aqify/
â”œâ”€â”€ ğŸ“ backend/
â”‚   â”œâ”€â”€ ğŸ“ pipeline/
â”‚   â”‚   â”œâ”€â”€ pathway_aqi_pipeline.py       # Main Pathway stream pipeline
â”‚   â”‚   â”œâ”€â”€ connectors/
â”‚   â”‚   â”‚   â”œâ”€â”€ waqi_connector.py         # WAQIStationConnectorSubject
â”‚   â”‚   â”‚   â””â”€â”€ open_meteo_connector.py   # OpenMeteoConnectorSubject
â”‚   â”‚   â”œâ”€â”€ udfs/
â”‚   â”‚   â”‚   â”œâ”€â”€ classify_aqi.py           # @pw.udf AQI classification
â”‚   â”‚   â”‚   â””â”€â”€ alert_filter.py           # @pw.udf threshold filtering
â”‚   â”‚   â””â”€â”€ requirements_pipeline.txt
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ api/
â”‚   â”‚   â”œâ”€â”€ main.py                       # FastAPI + Socket.IO server
â”‚   â”‚   â”œâ”€â”€ ğŸ“ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ aqi.py                    # Live AQI endpoints
â”‚   â”‚   â”‚   â”œâ”€â”€ history.py                # Historical analysis
â”‚   â”‚   â”‚   â”œâ”€â”€ rankings.py               # City rankings
â”‚   â”‚   â”‚   â”œâ”€â”€ pollutants.py             # Per-pollutant pages
â”‚   â”‚   â”‚   â”œâ”€â”€ blog.py                   # Auto-generated blog
â”‚   â”‚   â”‚   â””â”€â”€ gamification.py           # Points + badges
â”‚   â”‚   â”œâ”€â”€ ğŸ“ bridges/
â”‚   â”‚   â”‚   â””â”€â”€ redis_bridge.py           # Redis â†’ Socket.IO relay
â”‚   â”‚   â””â”€â”€ requirements_api.txt
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ data/
â”‚       â”œâ”€â”€ city_registry.py              # 45+ city slug + lat/lon registry
â”‚       â”œâ”€â”€ city_seed.sql
â”‚       â”œâ”€â”€ station_seed.sql
â”‚       â””â”€â”€ seed_historical.py            # Backfill 3 years of history
â”‚
â”œâ”€â”€ ğŸ“ frontend/
â”‚   â”œâ”€â”€ ğŸ“ src/
â”‚   â”‚   â”œâ”€â”€ ğŸ“ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx             # Live AQI dashboard
â”‚   â”‚   â”‚   â”œâ”€â”€ Heatmap.tsx               # India AQI map
â”‚   â”‚   â”‚   â”œâ”€â”€ Pollutants.tsx            # Per-pollutant charts
â”‚   â”‚   â”‚   â”œâ”€â”€ History.tsx               # Historical analysis
â”‚   â”‚   â”‚   â”œâ”€â”€ Rankings.tsx              # City rankings
â”‚   â”‚   â”‚   â”œâ”€â”€ Leaderboard.tsx           # Gamification board
â”‚   â”‚   â”‚   â””â”€â”€ Blog.tsx                  # Auto-generated posts
â”‚   â”‚   â”œâ”€â”€ ğŸ“ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ AQIGauge.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ HealthAdvisory.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ StationCard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ WeatherWidget.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ YoYInsight.tsx            # Same-day YoY text
â”‚   â”‚   â”‚   â”œâ”€â”€ ForecastChart.tsx
â”‚   â”‚   â”‚   â””â”€â”€ EmbedWidget.tsx           # Embeddable snippet
â”‚   â”‚   â”œâ”€â”€ ğŸ“ i18n/
â”‚   â”‚   â”‚   â”œâ”€â”€ en.json
â”‚   â”‚   â”‚   â”œâ”€â”€ hi.json
â”‚   â”‚   â”‚   â””â”€â”€ ta.json
â”‚   â”‚   â”œâ”€â”€ ğŸ“ store/
â”‚   â”‚   â”‚   â””â”€â”€ useAQIStore.ts            # Zustand global state
â”‚   â”‚   â””â”€â”€ ğŸ“ hooks/
â”‚   â”‚       â”œâ”€â”€ useSocket.ts              # Socket.IO live data
â”‚   â”‚       â””â”€â”€ useAQIHistory.ts
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env.example
â””â”€â”€ README.md
```

---

## ğŸš€ Quick Start

### Prerequisites

<p align="center">
<img src="https://img.shields.io/badge/Docker_Compose-â‰¥2.x-2496ED?style=for-the-badge&logo=docker&logoColor=white" />
<img src="https://img.shields.io/badge/Node.js-â‰¥18.x-339933?style=for-the-badge&logo=node.js&logoColor=white" />
<img src="https://img.shields.io/badge/Python-â‰¥3.11-3776AB?style=for-the-badge&logo=python&logoColor=white" />
</p>

### API Keys Needed

| Service | Required | Get It |
|---------|----------|--------|
| WAQI Token | âœ… Yes | [aqicn.org/data-platform/token](https://aqicn.org/data-platform/token/) |
| IPinfo Token | âœ… Yes | [ipinfo.io/account/token](https://ipinfo.io/account/token) |
| Supabase URL + Key | âœ… Yes | [supabase.com](https://supabase.com) |
| Open-Meteo | âŒ None needed | Free, no registration |

### Installation

```bash
# 1ï¸âƒ£ Clone the repository
git clone https://github.com/yourusername/aqify.git
cd aqify

# 2ï¸âƒ£ Configure environment
cp .env.example .env
# Fill in: WAQI_TOKEN, IPINFO_TOKEN, SUPABASE_URL, SUPABASE_KEY
# DATABASE_URL, REDIS_URL are pre-configured for docker-compose

# 3ï¸âƒ£ Seed the database
psql $DATABASE_URL < backend/data/city_seed.sql
psql $DATABASE_URL < backend/data/station_seed.sql

# 4ï¸âƒ£ (Optional but recommended) Backfill 3 years of history
python backend/data/seed_historical.py  # ~10 minutes

# 5ï¸âƒ£ Launch all 5 containers
docker-compose up --build
```

### Verify Everything is Running

```bash
# Check Pathway pipeline is writing data
docker exec aqify_pathway_aqi cat /tmp/aqi_output.jsonl | head -5

# Check Redis is receiving AQI updates
docker exec aqify_redis redis-cli subscribe aqi:live

# Check FastAPI is live
curl http://localhost:8000/health

# Check frontend
open http://localhost:3000
```

### Available Scripts

| Command | Description |
|---------|-------------|
| `docker-compose up --build` | ğŸš€ Launch all services |
| `docker-compose up pathway_aqi` | âš¡ Run pipeline only |
| `docker-compose logs -f api` | ğŸ“‹ Stream API logs |
| `POST /blog/generate/weekly` | ğŸ“ Trigger blog generation |
| `python backend/data/seed_historical.py` | ğŸ“Š Backfill historical data |

---

## ğŸŒ API Reference

<details>
<summary><b>âš¡ Live AQI Endpoints</b></summary>

```typescript
GET /api/aqi/city/{city_id}
// Live AQI for a city (joined AQI + weather)

GET /api/aqi/stations/{city_id}
// All monitoring stations within a city

GET /api/aqi/heatmap
// All 45+ cities with current AQI for map markers

// Socket.IO event (real-time)
socket.on('aqi_update', (data: AQIUpdate) => { ... })
socket.on('station_update', (data: StationUpdate) => { ... })
```
</details>

<details>
<summary><b>ğŸ“… Historical Analysis Endpoints</b></summary>

```typescript
GET /api/history/{city_id}/yoy?month=2&years=2023,2024,2025,2026
// Year-over-year monthly comparison data

GET /api/history/{city_id}/24h-pattern?days=30
// 24-hour AQI pattern averaged over last N days

GET /api/history/{city_id}/same-day-insight
// "Today ranks Xth worst for this calendar day across 3 years"
```
</details>

<details>
<summary><b>ğŸ”¬ Pollutant Endpoints</b></summary>

```typescript
GET /api/pollutants/{city_id}/{pollutant}
// pollutant: pm25 | pm10 | no2 | o3 | co | so2

Response: {
  readings: [{ timestamp, value, unit }],  // last 120
  average: number,
  maximum: number,
  minimum: number,
  safe_limit: number,   // WHO/EPA threshold
  unit: string
}
```
</details>

<details>
<summary><b>ğŸ™ï¸ Rankings Endpoint</b></summary>

```typescript
GET /api/rankings?sort=hottest|coldest|most_polluted|cleanest
// Returns 45+ cities sorted by chosen metric

Response: {
  cities: [{
    rank: number,
    city: string,
    country: string,
    aqi: number,
    temperature: number,
    humidity: number,
    wind_speed: number
  }],
  updated_at: string
}
```
</details>

<details>
<summary><b>ğŸ§© Embeddable Widget</b></summary>

```html
<!-- Embed AQI widget for any city -->
<script
  src="https://aqify.app/widget.js"
  data-city="indore"
  data-theme="light"
  data-lang="en"
></script>
```
</details>

---

## ğŸ§ª Pathway Implementation Notes

> For developers building on or extending AQIFY â€” key Pathway API gotchas and verified patterns.

### âœ… Verified API Patterns (v0.27.0)

| Pattern | Wrong âŒ | Correct âœ… |
|---------|----------|-----------|
| Polling external APIs | `pw.io.http.read(url)` | `pw.io.python.ConnectorSubject` |
| PostgreSQL write | `pw.io.postgres.write(..., output_table_type="snapshot")` | `pw.io.postgres.write_snapshot(table, settings, name, ["col"])` |
| UDF definition | `pw.apply(fn, pw.this.col)` | `@pw.udf def fn(...) -> type:` then `fn(pw.this.col)` |
| Primary key in write | `primary_key=[table.city_id]` | `primary_key=["city_id"]` (list of strings) |
| History table schema | Missing `time` + `diff` columns | Must include `time INTEGER NOT NULL` + `diff SMALLINT NOT NULL` |
| Postgres connection | `connection_string=os.environ[...]` | `postgres_settings = {host, port, dbname, user, password}` dict |

---

## ğŸ“ˆ Performance

<div align="center">

| Metric | Value |
|--------|-------|
| âš¡ AQI refresh rate | 60 seconds (WAQI) |
| ğŸŒ¤ï¸ Weather refresh rate | 300 seconds (Open-Meteo) |
| ğŸ™ï¸ Cities monitored | 45+ Indian cities |
| ğŸ“¡ Stations tracked | Sub-city resolution per city |
| ğŸ“¦ Total Docker size | ~676 MB (5 containers) |
| ğŸ–¥ï¸ Frontend bundle | ~584 KB gzipped |
| â±ï¸ Stream latency | <1 second Pathway â†’ Redis â†’ Socket.IO â†’ Browser |

</div>

---

## ğŸ—ºï¸ Roadmap

```mermaid
gantt
    title AQIFY Development Roadmap
    dateFormat  YYYY-MM-DD
    section Phase 1 â€” Core
    Pathway Pipeline + Dual Source     :done, 2024-01-01, 30d
    FastAPI + Socket.IO Bridge         :done, 2024-01-15, 20d
    React Dashboard + Heatmap          :done, 2024-02-01, 30d
    section Phase 2 â€” Depth
    Historical Analysis                :done, 2024-03-01, 20d
    Per-Pollutant Pages                :done, 2024-03-10, 15d
    City Rankings                      :done, 2024-03-20, 10d
    section Phase 3 â€” Reach
    Gamification + Leaderboard         :done, 2024-04-01, 20d
    Embeddable Widget                  :done, 2024-04-10, 10d
    i18n + Auto Blog                   :done, 2024-04-15, 15d
    section Phase 4 â€” Scale
    Mobile App (React Native)          :active, 2024-07-01, 90d
    IoT Sensor Integration             :2024-09-01, 60d
    ML-based AQI Forecasting           :2024-10-01, 90d
    Hyperlocal Sub-city Resolution     :2025-01-01, 120d
```

---

## ğŸ”’ Security & Privacy

- ğŸ” **Supabase Auth** â€” secure JWT-based authentication
- ğŸ›¡ï¸ **No PII stored** â€” only city-level location, no precise GPS retained
- ğŸ”‘ **API keys server-side only** â€” WAQI token never exposed to frontend
- ğŸ“ **Rate limiting** â€” FastAPI middleware prevents API abuse
- ğŸ³ **Container isolation** â€” each service in its own Docker network

---

## â“ FAQ

<details>
<summary><b>Q: Why Pathway instead of Celery or a simple cron job?</b></summary>
<br/>
<p>Pathway provides a true stream processing engine â€” data flows as events, joins happen on live tables, and the pipeline is stateful. Celery would require manual state management, doesn't support stream joins, and adds unnecessary complexity. Pathway gives us real-time semantics with minimal code.</p>
</details>

<details>
<summary><b>Q: Why WAQI over OpenWeatherMap for AQI?</b></summary>
<br/>
<p>OpenWeatherMap returns a 1â€“5 ordinal AQI index that requires manual conversion and loses precision. WAQI returns the real US EPA 0â€“500 scale directly from government monitoring stations â€” the same data used by official health agencies.</p>
</details>

<details>
<summary><b>Q: Is Open-Meteo truly free?</b></summary>
<br/>
<p>Yes â€” Open-Meteo is completely free with no API key required for non-commercial use. It provides hourly weather data, UV index, and 5-day AQI forecasts via the CAMS European air quality model.</p>
</details>

<details>
<summary><b>Q: How does the Year-over-Year insight work?</b></summary>
<br/>
<p>The Pathway pipeline writes every AQI reading to PostgreSQL with timestamps. The YoY endpoint queries the same calendar date across 2023, 2024, 2025, and 2026 and generates a natural-language ranking: "Today's AQI of 35 ranks 3rd worst for this day across 3 years."</p>
</details>

<details>
<summary><b>Q: Can I embed AQIFY data on my own website?</b></summary>
<br/>
<p>Yes! Use our embeddable widget â€” a single script tag that renders a live AQI card for any supported city. It auto-updates and is fully responsive.</p>
</details>

---

## ğŸ“œ Changelog

### v3.4 â€” Current

- â™»ï¸ RAG chatbot removed â€” simplified architecture
- ğŸ”§ All `pw.apply()` calls replaced with `@pw.udf` decorator (verified Pathway 0.27.0)
- ğŸ“¦ Split into per-container `requirements.txt` files

### v3.3

- ğŸ› ï¸ `pw.io.postgres.write_snapshot` Â· `primary_key=list[str]` Â· `time+diff` columns
- ğŸ”Œ GeminiEmbedder integration

### v3.0

- ğŸ†• Sub-city station drill-down
- ğŸ“… Multi-year historical analysis + day/night patterns
- ğŸ”¬ Per-pollutant dedicated pages
- ğŸ“Š Same-day year-over-year text insight
- ğŸ™ï¸ Live weather city rankings
- ğŸ§© Embeddable AQI widget
- ğŸŒ i18n multi-language support
- ğŸ“ Auto-generated SEO blog

### v2.0

- âš¡ Replaced all `pw.io.http.read` with `ConnectorSubject`
- ğŸ—ºï¸ Added `city_registry` normalisation layer
- ğŸš« Removed Celery entirely
- ğŸ”´ Redis pub/sub IPC bridge
- ğŸ“¡ Dual-source: WAQI + Open-Meteo

---

## ğŸ¤ Contributing

```bash
# Fork the repo, then:
git clone https://github.com/YOUR_USERNAME/aqify.git
git checkout -b feature/amazing-feature

# Make changes...
git commit -m "feat: add amazing feature"
git push origin feature/amazing-feature
# Open a Pull Request
```

Please read [CONTRIBUTING.md](CONTRIBUTING.md) before submitting. We welcome bug reports, feature requests, and new city additions to the registry.

---

## ğŸ“„ License

<div align="center">

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg?style=for-the-badge)](https://opensource.org/licenses/MIT)

</div>

---

<div align="center">

<img src="https://capsule-render.vercel.app/api?type=waving&color=gradient&customColorList=2,12,24&height=100&section=footer" />

### Built with â¤ï¸ and clean(ish) air

<p>
<img src="https://img.shields.io/badge/Powered_by-Pathway-6366F1?style=for-the-badge&logo=python&logoColor=white" />
<img src="https://img.shields.io/badge/Built_with-React_18-61DAFB?style=for-the-badge&logo=react&logoColor=black" />
<img src="https://img.shields.io/badge/Monitoring-45+_Indian_Cities-FF9933?style=for-the-badge" />
</p>

### â­ Star this repo if AQIFY helped you breathe more mindfully!

---

**AQIFY** â€” *Real-Time AQI Intelligence Engine* ğŸŒ«ï¸

</div>
